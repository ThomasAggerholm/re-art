{% if section.blocks.size > 0 %}
    {% assign nav = bs.nav %}
{% else %}
    {% assign s = section.settings %}
    {% assign nav = s.nav %}
{% endif %}

<ul class="{{ class }}__menu">
{% for link in linklists[nav].links %}
    <li class="menu__item">
        <a href="{{ link.url }}" class="menu__item__link" data-item-name="{{ link.title }}">{{ link.title }}</a>

        {% if link.links != blank %}
            <div class="megamenu">
                <div class="megamenu__inner">
                    {% for child_link in link.links %}
                        <div class="megamenu__col">
                            <ul>
                                <li class="child-link__menu__item">
                                    <a class="child-link" href="{{ child_link.url }}">{{ child_link.title }}</a>
                                    <div class="megamenu__grandchild">
                                        <ul>
                                            {% for grandchild_link in child_link.links %}
                                                <li class="grandchild-link__menu__item">
                                                    <a class="grandchild-link" href="{{ grandchild_link.url }}">{{ grandchild_link.title }}</a>
                                                </li> 
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </li>
{% endfor %}
</ul>